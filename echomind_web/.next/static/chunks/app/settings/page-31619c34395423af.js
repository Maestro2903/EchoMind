(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{493:function(e,t,a){Promise.resolve().then(a.bind(a,7592))},7592:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return u}});var r=a(7437),s=a(2265),n=a(9763);let o=(0,n.Z)("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),l=(0,n.Z)("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);var i=a(6265),c=a(1784),d=a(9376);function u(){let{user:e,isLoading:t,mode:a}=(0,i.a)(),[n,u]=(0,s.useState)("profile"),[m,x]=(0,s.useState)(null),[y,h]=(0,s.useState)(!1),[f,b]=(0,s.useState)(""),[p,g]=(0,s.useState)(!1),[w,v]=(0,s.useState)(""),j=(0,d.useRouter)(),N=async()=>{try{let e=await (0,c.ud)();h(e.hasApiKey)}catch(e){console.error("Failed to fetch API key status:",e)}};if((0,s.useEffect)(()=>{if(e)return(async()=>{try{let e=await (0,c.et)();x(e),v(e.display_name),await N()}catch(e){console.error("Failed to fetch profile data:",e)}})(),window.ipcRenderer&&window.ipcRenderer.on("api-key-updated",()=>{console.log("Received api-key-updated event from main process."),N()}),()=>{window.ipcRenderer&&window.ipcRenderer.removeAllListeners("api-key-updated")}},[e]),t)return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})});if(!e)return j.push("/login"),null;let k="firebase"===a,P=async()=>{g(!0);try{await (0,c.ks)(f),h(!0),b(""),window.ipcRenderer&&window.ipcRenderer.invoke("save-api-key",f)}catch(e){console.error("Failed to save API key:",e)}finally{g(!1)}},A=async()=>{if(m&&w!==m.display_name){g(!0);try{await (0,c.Lj)({displayName:w}),x(e=>e?{...e,display_name:w}:null)}catch(e){console.error("Failed to update display name:",e)}finally{g(!1)}}},S=async()=>{let e=k?"Are you sure you want to delete your account? This action cannot be undone and all data stored in Firebase will be deleted.":"Are you sure you want to delete your account? This action cannot be undone and all data will be deleted.";if(window.confirm(e))try{await (0,c.tm)(),j.push("/login")}catch(e){console.error("Failed to delete account:",e)}},C=async()=>{try{await (0,c.kS)()}catch(e){console.error("Logout failed:",e)}};return(0,r.jsx)("div",{className:"bg-stone-50 min-h-screen",children:(0,r.jsxs)("div",{className:"px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Settings"}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Personal Settings"})]}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)("nav",{className:"flex space-x-10",children:[{id:"profile",name:"Personal Profile",href:"/settings"}].map(e=>(0,r.jsx)("a",{href:e.href,onClick:()=>u(e.id),className:"pb-4 px-2 border-b-2 font-medium text-sm transition-colors ".concat(n===e.id?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:e.name},e.id))})}),"profile"===n?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"p-4 rounded-lg border ".concat(k?"bg-blue-50 border-blue-200":"bg-gray-50 border-gray-200"),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[k?(0,r.jsx)(o,{className:"h-5 w-5 text-blue-600"}):(0,r.jsx)(l,{className:"h-5 w-5 text-gray-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold ".concat(k?"text-blue-900":"text-gray-900"),children:k?"Firebase Hosting Mode":"Local Execution Mode"}),(0,r.jsx)("p",{className:"text-sm ".concat(k?"text-blue-700":"text-gray-700"),children:k?"Logged in with Google account (".concat(e.email,")"):"Running as local user"})]})]}),k&&(0,r.jsx)("button",{onClick:C,className:"px-3 py-1 text-sm text-blue-600 hover:text-blue-700 underline",children:"Logout"})]})}),(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Display Name"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Enter your full name or a display name you're comfortable using."}),(0,r.jsxs)("div",{className:"max-w-sm",children:[(0,r.jsx)("input",{type:"text",id:"display-name",value:w,onChange:e=>v(e.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm text-black",maxLength:32}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"You can use up to 32 characters."})]}),(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 flex justify-end",children:(0,r.jsx)("button",{onClick:A,disabled:p||!w||w===(null==m?void 0:m.display_name),className:"px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-gray-800 hover:bg-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-900 disabled:opacity-50",children:"Update"})})]}),!k&&(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"API Key"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"If you want to use your own LLM API key, you can add it here. It will be used for all requests made by the local application."}),(0,r.jsxs)("div",{className:"max-w-sm",children:[(0,r.jsx)("label",{htmlFor:"api-key",className:"block text-sm font-medium text-gray-700 mb-1",children:"API Key"}),(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsx)("input",{type:"password",id:"api-key",value:f,onChange:e=>b(e.target.value),className:"flex-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm text-black",placeholder:"Enter new API key or existing API key"})}),y?(0,r.jsx)("p",{className:"text-xs text-green-600 mt-2",children:"API key is currently set."}):(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"No API key set. Using free system."})]}),(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 flex justify-end",children:(0,r.jsx)("button",{onClick:P,disabled:p||!f,className:"px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-gray-800 hover:bg-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-900 disabled:opacity-50",children:p?"Saving...":"Save"})})]}),(k||!k&&!y)&&(0,r.jsxs)("div",{className:"bg-white border border-red-300 rounded-lg p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Delete Account"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:k?"Permanently remove your Firebase account and all content. This action cannot be undone, so please proceed carefully.":"Permanently remove your personal account and all content from the EchoMind platform. This action cannot be undone, so please proceed carefully."}),(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 flex justify-end",children:(0,r.jsx)("button",{onClick:S,className:"px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete"})})]})]}):(0,r.jsx)("div",{className:"space-y-6"})]})})}},9763:function(e,t,a){"use strict";a.d(t,{Z:function(){return o}});var r=a(2265),s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),o=(e,t)=>{let a=(0,r.forwardRef)((a,o)=>{let{color:l="currentColor",size:i=24,strokeWidth:c=2,absoluteStrokeWidth:d,className:u="",children:m,...x}=a;return(0,r.createElement)("svg",{ref:o,...s,width:i,height:i,stroke:l,strokeWidth:d?24*Number(c)/Number(i):c,className:["lucide","lucide-".concat(n(e)),u].join(" "),...x},[...t.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(m)?m:[m]])});return a.displayName="".concat(e),a}},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},6265:function(e,t,a){"use strict";a.d(t,{a:function(){return c},g:function(){return d}});var r=a(2265),s=a(9376),n=a(1784),o=a(1694),l=a(3301);let i={uid:"default_user",display_name:"Default User",email:"contact@echomind.com"},c=()=>{let[e,t]=(0,r.useState)(null),[a,s]=(0,r.useState)(!0),[c,d]=(0,r.useState)(null);return(0,r.useEffect)(()=>{let e=(0,l.Aj)(o.I8,async e=>{if(e){console.log("\uD83D\uDD25 Firebase mode activated:",e.uid),d("firebase");let a={uid:e.uid,display_name:e.displayName||"User",email:e.email||"no-email@example.com"};try{a=await (0,n.Oo)(a),console.log("✅ Firestore user created/verified:",a)}catch(e){console.error("❌ Firestore user creation/verification failed:",e)}t(a),(0,n.ps)(a)}else console.log("\uD83C\uDFE0 Local mode activated"),d("local"),t(i),(0,n.ps)(i);s(!1)});return()=>e()},[]),{user:e,isLoading:a,mode:c}},d=()=>{let{user:e,isLoading:t}=c(),a=(0,s.useRouter)();return(0,r.useEffect)(()=>{},[e,t,a]),e}}},function(e){e.O(0,[358,990,915,784,971,117,744],function(){return e(e.s=493)}),_N_E=e.O()}]);